module.exports=[54829,a=>{"use strict";var b=a.i(87924),c=a.i(5784),d=a.i(79360),e=a.i(87532),f=a.i(72162),g=a.i(77156),h=a.i(81560);let i=(0,a.i(70106).default)("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]);var j=a.i(4720),k=a.i(46842),l=a.i(72131),m=a.i(56711),n=a.i(50944),o=a.i(38246),p=a.i(33022),q=a.i(40695),r=a.i(76504),s=a.i(65733),t=a.i(5522),u=a.i(17171),v=a.i(46893),w=a.i(87682),x=a.i(70246),y=a.i(73993),z=(0,y.createServerReference)("605119fd3bb11cba9580e24bcd1ac8c5475ab8e7b8",y.callServer,void 0,y.findSourceMapURL,"updateReportAction"),A=(0,y.createServerReference)("4078aa72216dd8618e19b64ad67dd64058f296d8fe",y.callServer,void 0,y.findSourceMapURL,"deleteReportAction");function B({initialData:a,totalPages:y,currentPage:B,stats:D,searchQuery:E,statusFilter:F,typeFilter:G}){var H;let I=(0,n.useRouter)(),J=(0,n.useSearchParams)(),[K,L]=(0,l.useTransition)(),{toast:M}=(0,x.useToast)(),[N,O]=(0,l.useState)(E),[P,Q]=(0,l.useState)({open:!1,id:"",currentStatus:"",newStatus:"",reportTitle:""}),[R,S]=(0,l.useState)({open:!1,report:null}),[T,U]=(0,l.useState)({open:!1,id:"",reportTitle:"",confirmText:""}),[V,W]=(0,l.useState)({open:!1,id:"",notes:"",reportTitle:""}),X=a=>{let b=new URLSearchParams(J.toString());Object.entries(a).forEach(([a,c])=>{c&&"all"!==c&&""!==c?b.set(a,String(c)):b.delete(a)}),L(()=>{I.push(`?${b.toString()}`)})},Y=()=>{X({search:N,page:1})},Z=async()=>{let a={status:P.newStatus};"resolved"===P.newStatus&&(a.resolved_at=new Date().toISOString());let{error:b}=await z(P.id,a);b?M({title:"Error",description:"Gagal mengubah status",variant:"destructive"}):(M({title:"Berhasil",description:"Status berhasil diubah"}),I.refresh()),Q(a=>({...a,open:!1}))},$=async()=>{if("Delete Report"!==T.confirmText)return;let{error:a}=await A(T.id);a?M({title:"Error",description:"Failed to delete report",variant:"destructive"}):(M({title:"Success",description:"Report deleted successfully"}),I.refresh()),U(a=>({...a,open:!1,confirmText:""}))},_=async()=>{let{error:a}=await z(V.id,{admin_notes:V.notes});a?M({title:"Error",description:"Gagal menyimpan catatan",variant:"destructive"}):(M({title:"Berhasil",description:"Catatan berhasil disimpan"}),I.refresh()),W(a=>({...a,open:!1}))},aa=[{key:"reporter",label:"Reporter",render:(a,c)=>{let d=c.reporterData;if(!d)return(0,b.jsx)("span",{className:"text-muted-foreground",children:"—"});let e=d.fullname||d.username||"Unknown",f=d.username?`@${d.username}`:"No username";return(0,b.jsx)(o.default,{href:`/users/${d.id}`,className:"flex items-center gap-3 cursor-pointer",children:(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"font-medium leading-tight hover:text-primary transition-colors",children:e}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:f})]})})}},{key:"title",label:"Title",render:a=>{let c=(a||"Untitled").replace(/^Laporan\s+/i,"");return(0,b.jsx)("div",{className:"max-w-[250px]",children:(0,b.jsx)("p",{className:"font-medium truncate",title:c,children:c})})}},{key:"description",label:"Description",render:a=>(0,b.jsx)("div",{className:"max-w-[250px]",children:(0,b.jsx)("p",{className:"truncate",children:a||"No description provided"})})},{key:"reported",label:"Type",render:(a,c)=>{let d=c.reported_content_type,e=c.reportedUserData,f=c.reported_content_id;return"user"===d&&e?(0,b.jsxs)(o.default,{href:`/users/${e.id}`,className:"flex items-center gap-2 cursor-pointer",children:[(0,b.jsx)(k.User,{className:"h-4 w-4 text-muted-foreground"}),(0,b.jsx)("span",{className:"text-sm hover:text-primary transition-colors",children:e.fullname||e.username||"Unknown"})]}):"quiz"===d&&f?(0,b.jsxs)(o.default,{href:`/quizzes/${f}`,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2 cursor-pointer group",children:[(0,b.jsx)(j.FileText,{className:"h-4 w-4 text-muted-foreground group-hover:text-primary transition-colors"}),(0,b.jsx)("span",{className:"text-sm hover:text-primary transition-colors text-muted-foreground group-hover:text-primary",children:"Quiz"})]}):d?(0,b.jsx)("span",{className:"text-sm text-muted-foreground capitalize",children:d}):(0,b.jsx)("span",{className:"text-muted-foreground",children:"—"})}},{key:"status",label:"Status",render:(a,d)=>{let e=C(a),f=d.id,g=d.title;return(0,b.jsxs)(r.DropdownMenu,{children:[(0,b.jsx)(r.DropdownMenuTrigger,{className:"focus:outline-none",children:(0,b.jsxs)("div",{className:"cursor-pointer hover:opacity-80 flex items-center",children:[(0,b.jsx)(p.StatusBadge,{status:e}),(0,b.jsx)(c.ChevronDown,{className:"ml-1.5 h-3 w-3 text-muted-foreground/50"})]})}),(0,b.jsx)(r.DropdownMenuContent,{align:"start",children:["Pending","In Progress","Resolved"].filter(a=>a!==e).map(a=>(0,b.jsx)(r.DropdownMenuItem,{onClick:()=>{Q({open:!0,id:f,currentStatus:e,newStatus:a.toLowerCase().replace(" ","_"),reportTitle:g})},className:"cursor-pointer",children:a},a))})]})}},{key:"date",label:"Date",render:a=>(0,b.jsx)("span",{className:"text-sm text-muted-foreground",children:a?(0,m.format)(new Date(a),"dd MMM yyyy"):"—"})},{key:"action",label:"Action",render:(a,c)=>{let e=c.id,f=c.title||"Untitled",j=c.admin_notes;return c.fullReport,(0,b.jsxs)(r.DropdownMenu,{children:[(0,b.jsx)(r.DropdownMenuTrigger,{className:"focus:outline-none",children:(0,b.jsx)("div",{className:"cursor-pointer hover:opacity-80 p-1 rounded hover:bg-muted",children:(0,b.jsx)(d.MoreVertical,{className:"h-4 w-4 text-muted-foreground"})})}),(0,b.jsxs)(r.DropdownMenuContent,{align:"end",children:[(0,b.jsx)(r.DropdownMenuItem,{asChild:!0,className:"cursor-pointer",children:(0,b.jsxs)(o.default,{href:`/reports/${e}`,children:[(0,b.jsx)(g.Eye,{className:"h-4 w-4 mr-2"}),"View Details"]})}),(0,b.jsxs)(r.DropdownMenuItem,{onClick:()=>W({open:!0,id:e,notes:j||"",reportTitle:f}),className:"cursor-pointer",children:[(0,b.jsx)(i,{className:"h-4 w-4 mr-2"}),"Admin Notes"]}),(0,b.jsx)(r.DropdownMenuSeparator,{}),(0,b.jsxs)(r.DropdownMenuItem,{onClick:()=>U({open:!0,id:e,reportTitle:f,confirmText:""}),className:"cursor-pointer text-destructive focus:text-destructive",children:[(0,b.jsx)(h.Trash2,{className:"h-4 w-4 mr-2"}),"Delete Report"]})]})]})}}],ab=a.map(a=>({id:a.id,reporterData:a.reporter,title:a.title,description:a.description,report_type:a.report_type,reported_content_type:a.reported_content_type,reported_content_id:a.reported_content_id,reportedUserData:a.reported_user,status:a.status,date:a.created_at,admin_notes:a.admin_notes,fullReport:a}));return(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsx)("div",{children:(0,b.jsx)("h1",{className:"text-3xl font-bold text-foreground",children:"Reports"})}),(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)(t.Input,{placeholder:"Cari laporan...",className:"pr-10 w-64 bg-background border-border",value:N,onChange:a=>O(a.target.value),onKeyDown:a=>{"Enter"===a.key&&Y()}}),(0,b.jsx)("button",{onClick:Y,disabled:K,className:"absolute right-1 top-1/2 -translate-y-1/2 h-7 w-7 flex items-center justify-center rounded-md bg-primary text-primary-foreground hover:bg-primary/90 disabled:opacity-50 transition-colors",children:(0,b.jsx)(e.Search,{className:"h-3.5 w-3.5"})})]}),(0,b.jsxs)(w.Select,{value:F,onValueChange:a=>X({status:a,page:1}),children:[(0,b.jsx)(w.SelectTrigger,{className:"w-36",children:(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(f.SlidersHorizontal,{className:"h-4 w-4"}),(0,b.jsx)(w.SelectValue,{placeholder:"Status"})]})}),(0,b.jsxs)(w.SelectContent,{children:[(0,b.jsx)(w.SelectItem,{value:"all",children:"All Status"}),(0,b.jsx)(w.SelectItem,{value:"pending",children:"Pending"}),(0,b.jsx)(w.SelectItem,{value:"in_progress",children:"In Progress"}),(0,b.jsx)(w.SelectItem,{value:"resolved",children:"Resolved"})]})]})]})]}),(0,b.jsx)("div",{className:K?"opacity-60 pointer-events-none":"",children:(0,b.jsx)(p.DataTable,{columns:aa,data:ab,currentPage:B,totalPages:y,onPageChange:a=>{X({page:a,search:E,status:F,type:G}),window.scrollTo({top:0,behavior:"smooth"})},onRowClick:a=>I.push(`/reports/${a.id}`)})}),(0,b.jsx)(s.Dialog,{open:P.open,onOpenChange:a=>Q(b=>({...b,open:a})),children:(0,b.jsxs)(s.DialogContent,{showCloseButton:!1,children:[(0,b.jsxs)(s.DialogHeader,{children:[(0,b.jsx)(s.DialogTitle,{children:"Ubah Status"}),(0,b.jsx)(s.DialogDescription,{children:"Apakah Anda yakin ingin mengubah status dari?"})]}),(0,b.jsxs)(s.DialogFooter,{children:[(0,b.jsx)(q.Button,{variant:"outline",onClick:()=>Q(a=>({...a,open:!1})),children:"Batal"}),(0,b.jsx)(q.Button,{onClick:Z,children:"Ubah"})]})]})}),(0,b.jsx)(s.Dialog,{open:R.open,onOpenChange:a=>S(b=>({...b,open:a})),children:(0,b.jsxs)(s.DialogContent,{className:"max-w-lg",children:[(0,b.jsx)(s.DialogHeader,{children:(0,b.jsx)(s.DialogTitle,{children:R.report?.title||"Report Details"})}),R.report&&(0,b.jsxs)("div",{className:"space-y-4 py-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(u.Label,{className:"text-muted-foreground",children:"Description"}),(0,b.jsx)("p",{className:"mt-1",children:R.report.description||"—"})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(u.Label,{className:"text-muted-foreground",children:"Type"}),(0,b.jsx)("p",{className:"mt-1",children:(H=R.report.report_type)?H.charAt(0).toUpperCase()+H.slice(1).toLowerCase():"Other"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(u.Label,{className:"text-muted-foreground",children:"Status"}),(0,b.jsx)("p",{className:"mt-1",children:C(R.report.status)})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(u.Label,{className:"text-muted-foreground",children:"Created"}),(0,b.jsx)("p",{className:"mt-1",children:R.report.created_at?(0,m.format)(new Date(R.report.created_at),"dd MMM yyyy HH:mm"):"—"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(u.Label,{className:"text-muted-foreground",children:"Reporter"}),(0,b.jsx)("p",{className:"mt-1",children:R.report.reporter?.fullname||R.report.reporter?.username||"—"})]})]}),R.report.admin_notes&&(0,b.jsxs)("div",{children:[(0,b.jsx)(u.Label,{className:"text-muted-foreground",children:"Admin Notes"}),(0,b.jsx)("p",{className:"mt-1 text-sm bg-muted p-2 rounded",children:R.report.admin_notes})]})]})]})}),(0,b.jsx)(s.Dialog,{open:V.open,onOpenChange:a=>W(b=>({...b,open:a})),children:(0,b.jsxs)(s.DialogContent,{children:[(0,b.jsx)(s.DialogHeader,{children:(0,b.jsxs)(s.DialogTitle,{children:["Admin Notes - ",V.reportTitle]})}),(0,b.jsx)("div",{className:"py-4",children:(0,b.jsx)(v.Textarea,{value:V.notes,onChange:a=>W(b=>({...b,notes:a.target.value})),placeholder:"Tambahkan catatan admin...",rows:4})}),(0,b.jsxs)(s.DialogFooter,{children:[(0,b.jsx)(q.Button,{variant:"outline",onClick:()=>W(a=>({...a,open:!1})),children:"Batal"}),(0,b.jsx)(q.Button,{onClick:_,children:"Simpan"})]})]})}),(0,b.jsx)(s.Dialog,{open:T.open,onOpenChange:a=>U(b=>({...b,open:a,confirmText:""})),children:(0,b.jsxs)(s.DialogContent,{showCloseButton:!1,children:[(0,b.jsxs)(s.DialogHeader,{children:[(0,b.jsx)(s.DialogTitle,{className:"text-destructive",children:"Delete Report"}),(0,b.jsxs)(s.DialogDescription,{children:["Are you sure you want to delete report"," ",(0,b.jsx)("strong",{children:T.reportTitle}),"? This action cannot be undone."]})]}),(0,b.jsxs)("div",{className:"grid gap-2 py-4",children:[(0,b.jsxs)(u.Label,{htmlFor:"confirmDelete",children:["Type ",(0,b.jsx)("strong",{className:"text-destructive",children:"Delete Report"})," ","to confirm"]}),(0,b.jsx)(t.Input,{id:"confirmDelete",value:T.confirmText,onChange:a=>U(b=>({...b,confirmText:a.target.value})),placeholder:"Type 'Delete Report' here"})]}),(0,b.jsxs)(s.DialogFooter,{children:[(0,b.jsx)(q.Button,{variant:"outline",onClick:()=>U(a=>({...a,open:!1,confirmText:""})),children:"Cancel"}),(0,b.jsx)(q.Button,{variant:"destructive",onClick:$,disabled:"Delete Report"!==T.confirmText,children:"Delete Report"})]})]})})]})}function C(a){return a?a.split("_").map(a=>a.charAt(0).toUpperCase()+a.slice(1).toLowerCase()).join(" "):"Pending"}a.s(["ReportTable",()=>B],54829)}];

//# sourceMappingURL=app_%28dashboard%29_reports_report-table_tsx_48e360d0._.js.map