module.exports=[54599,a=>{"use strict";var b=a.i(87924),c=a.i(5784),d=a.i(79360);let e=(0,a.i(70106).default)("UserPen",[["path",{d:"M11.5 15H7a4 4 0 0 0-4 4v2",key:"15lzij"}],["path",{d:"M21.378 16.626a1 1 0 0 0-3.004-3.004l-4.01 4.012a2 2 0 0 0-.506.854l-.837 2.87a.5.5 0 0 0 .62.62l2.87-.837a2 2 0 0 0 .854-.506z",key:"1817ys"}],["circle",{cx:"10",cy:"7",r:"4",key:"e45bow"}]]);var f=a.i(81560),g=a.i(87532),h=a.i(72162),i=a.i(72131),j=a.i(50944),k=a.i(38246),l=a.i(33022),m=a.i(97895),n=a.i(40695),o=a.i(54161),p=a.i(7706),q=a.i(76504),r=a.i(65733),s=a.i(5522),t=a.i(17171),u=a.i(87682),v=a.i(70246),w=a.i(73993),x=(0,w.createServerReference)("60a15162366377943a3e23738e78de1e1e09a224da",w.callServer,void 0,w.findSourceMapURL,"updateProfileAction"),y=(0,w.createServerReference)("409eb8c54c498120c30cb6b42f4cedc11e98b7d901",w.callServer,void 0,w.findSourceMapURL,"deleteProfileAction");let z={admin:"bg-primary/20 text-primary border-primary/30",manager:"bg-[var(--success)]/20 text-[var(--success)] border-[var(--success)]/30",support:"bg-[var(--warning)]/20 text-[var(--warning)] border-[var(--warning)]/30",billing:"bg-chart-2/20 text-chart-2 border-chart-2/30"};function A({initialData:a,totalPages:w,currentPage:A,searchQuery:C,roleFilter:D,statusFilter:E}){let F=(0,j.useRouter)(),G=(0,j.useSearchParams)(),[H,I]=(0,i.useTransition)(),{toast:J}=(0,v.useToast)(),[K,L]=(0,i.useState)(C),[M,N]=(0,i.useState)({open:!1,type:"role",id:"",currentValue:"",newValue:"",userName:""}),[O,P]=(0,i.useState)({open:!1,id:"",fullname:"",username:"",role:"user",originalRole:"user",status:"active",showConfirm:!1}),[Q,R]=(0,i.useState)({open:!1,id:"",userName:"",confirmText:""}),S=a=>{let b=new URLSearchParams(G.toString());Object.entries(a).forEach(([a,c])=>{c&&"all"!==c&&""!==c?b.set(a,String(c)):b.delete(a)}),I(()=>{F.push(`?${b.toString()}`)})},T=()=>{S({search:K,page:1})},U=(a,b,c,d,e)=>{N({open:!0,type:a,id:b,currentValue:c,newValue:d,userName:e})},V=async()=>{if("role"===M.type){let a="admin"===M.newValue,{error:b}=await x(M.id,{role:M.newValue,admin_since:a?new Date().toISOString():null});b?J({title:"Error",description:"Failed to update role",variant:"destructive"}):(J({title:"Success",description:"Role updated successfully"}),F.refresh())}else{let a="Blocked"===M.newValue,{error:b}=await x(M.id,{is_blocked:a,blocked_at:a?new Date().toISOString():null});b?J({title:"Error",description:"Failed to update status",variant:"destructive"}):(J({title:"Success",description:"Status updated successfully"}),F.refresh())}N(a=>({...a,open:!1}))},W=async()=>{if(!O.showConfirm)return void P(a=>({...a,showConfirm:!0}));let a="blocked"===O.status,b={fullname:O.fullname,username:O.username,role:O.role,is_blocked:a,blocked_at:a?new Date().toISOString():null};"admin"===O.role&&"admin"!==O.originalRole?b.admin_since=new Date().toISOString():"admin"!==O.role&&"admin"===O.originalRole&&(b.admin_since=null);let{error:c}=await x(O.id,b);c?J({title:"Error",description:"Gagal menyimpan perubahan",variant:"destructive"}):(J({title:"Berhasil",description:"Data pengguna berhasil diperbarui"}),F.refresh()),P(a=>({...a,open:!1,showConfirm:!1}))},X=async()=>{if("Move to Trash"!==Q.confirmText)return;let{error:a}=await y(Q.id);a?J({title:"Error",description:"Gagal menghapus pengguna",variant:"destructive"}):(J({title:"Success",description:"User moved to trash successfully"}),F.refresh()),R(a=>({...a,open:!1,confirmText:""}))},Y=[{key:"account",label:"Account",render:(a,c)=>{let d=c.id,e=c.fullname||c.username||"Unknown user",f=c.username,g=f&&"—"!==f?`@${f}`:"—",h=c.avatar;return(0,b.jsxs)(k.default,{href:`/users/${d}`,className:"flex items-center gap-3 cursor-pointer",children:[(0,b.jsxs)(p.Avatar,{className:"h-9 w-9",children:[(0,b.jsx)(p.AvatarImage,{src:h,alt:e}),(0,b.jsx)(p.AvatarFallback,{children:e.split(" ").map(a=>a[0]).join("").toUpperCase().slice(0,2)})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"font-medium leading-tight hover:text-primary transition-colors",children:e}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:g})]})]})}},{key:"role",label:"Role",render:(a,d)=>{let e=a||"user",f=d.id,g=d.fullname||d.username||"Unknown user";return(0,b.jsxs)(q.DropdownMenu,{children:[(0,b.jsx)(q.DropdownMenuTrigger,{className:"focus:outline-none",children:(0,b.jsxs)("div",{className:"cursor-pointer hover:opacity-80 flex items-center",children:[(0,b.jsx)(o.Badge,{variant:"outline",className:z[e.toLowerCase()]??"bg-secondary text-secondary-foreground border-border",children:B(e)}),(0,b.jsx)(c.ChevronDown,{className:"ml-1.5 h-3 w-3 text-muted-foreground/50"})]})}),(0,b.jsx)(q.DropdownMenuContent,{align:"start",children:["user","admin"].filter(a=>a!==e.toLowerCase()).map(a=>(0,b.jsx)(q.DropdownMenuItem,{onClick:()=>U("role",f,e,a,g),className:"cursor-pointer",children:B(a)},a))})]})}},{key:"status",label:"Status",render:(a,d)=>{let e=d.id,f=d.fullname||d.username||"Unknown user";return(0,b.jsxs)(q.DropdownMenu,{children:[(0,b.jsx)(q.DropdownMenuTrigger,{className:"focus:outline-none",children:(0,b.jsxs)("div",{className:"cursor-pointer hover:opacity-80 flex items-center",children:[(0,b.jsx)(l.StatusBadge,{status:a}),(0,b.jsx)(c.ChevronDown,{className:"ml-1.5 h-3 w-3 text-muted-foreground/50"})]})}),(0,b.jsxs)(q.DropdownMenuContent,{align:"start",children:["Active"!==a&&(0,b.jsx)(q.DropdownMenuItem,{onClick:()=>U("status",e,a,"Active",f),className:"cursor-pointer",children:"Active"}),"Blocked"!==a&&(0,b.jsx)(q.DropdownMenuItem,{onClick:()=>U("status",e,a,"Blocked",f),className:"cursor-pointer",children:"Blocked"})]})]})}},{key:"location",label:"Locations",render:(a,c)=>{let d=c.state||"",e=c.city||"";if(!d&&!e)return(0,b.jsx)("span",{className:"text-muted-foreground",children:"-"});let f=[d,e].filter(Boolean).join(", "),g=encodeURIComponent(f);return(0,b.jsx)("a",{href:`https://www.google.com/maps/search/?api=1&query=${g}`,target:"_blank",rel:"noopener noreferrer",className:"text-sm font-medium hover:underline hover:text-primary transition-colors",title:"View on Google Maps",onClick:a=>a.stopPropagation(),children:f})}},{key:"action",label:"Action",render:(a,c)=>{let g=c.fullname||c.username||"Unknown user",h=c.id;return(0,b.jsxs)(q.DropdownMenu,{children:[(0,b.jsx)(q.DropdownMenuTrigger,{className:"focus:outline-none",children:(0,b.jsx)("div",{className:"cursor-pointer hover:opacity-80 p-1 rounded hover:bg-muted",children:(0,b.jsx)(d.MoreVertical,{className:"h-4 w-4 text-muted-foreground"})})}),(0,b.jsxs)(q.DropdownMenuContent,{align:"end",children:[(0,b.jsxs)(q.DropdownMenuItem,{onClick:()=>{let a;return a=(c.role||"user").toLowerCase(),void P({open:!0,id:c.id,fullname:c.fullname||"",username:c.username||"",role:a,originalRole:a,status:"Blocked"===c.status?"blocked":"active",showConfirm:!1})},className:"cursor-pointer",children:[(0,b.jsx)(e,{className:"h-4 w-4 mr-2"}),"Edit User"]}),(0,b.jsx)(q.DropdownMenuSeparator,{}),(0,b.jsxs)(q.DropdownMenuItem,{onClick:()=>{R({open:!0,id:h,userName:g,confirmText:""})},className:"cursor-pointer text-destructive focus:text-destructive",children:[(0,b.jsx)(f.Trash2,{className:"h-4 w-4 mr-2"}),"Move to Trash"]})]})]})}}],Z=a.map(a=>({id:a.id,account:a.id,avatar:(0,m.getAvatarUrl)(a.avatar_url),fullname:a.fullname,username:a.username??"—",email:a.email,role:a.role??"user",status:a.is_blocked?"Blocked":"Active",state:a.state?.name,city:a.city?.name}));return(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsx)("div",{children:(0,b.jsx)("h1",{className:"text-3xl font-bold text-foreground",children:"Users"})}),(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)(s.Input,{placeholder:"Cari pengguna...",className:"pr-10 w-64 bg-background border-border",value:K,onChange:a=>L(a.target.value),onKeyDown:a=>{"Enter"===a.key&&T()}}),(0,b.jsx)("button",{onClick:T,disabled:H,className:"absolute right-1 top-1/2 -translate-y-1/2 h-7 w-7 flex items-center justify-center rounded-md bg-primary text-primary-foreground hover:bg-primary/90 disabled:opacity-50 transition-colors",children:(0,b.jsx)(g.Search,{className:"h-3.5 w-3.5"})})]}),(0,b.jsxs)(u.Select,{value:D,onValueChange:a=>S({role:a,page:1}),children:[(0,b.jsx)(u.SelectTrigger,{className:"w-32",children:(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(h.SlidersHorizontal,{className:"h-4 w-4"}),(0,b.jsx)(u.SelectValue,{placeholder:"Role"})]})}),(0,b.jsxs)(u.SelectContent,{children:[(0,b.jsx)(u.SelectItem,{value:"all",children:"All Roles"}),(0,b.jsx)(u.SelectItem,{value:"user",children:"User"}),(0,b.jsx)(u.SelectItem,{value:"admin",children:"Admin"})]})]}),(0,b.jsxs)(u.Select,{value:E,onValueChange:a=>S({status:a,page:1}),children:[(0,b.jsx)(u.SelectTrigger,{className:"w-32",children:(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(h.SlidersHorizontal,{className:"h-4 w-4"}),(0,b.jsx)(u.SelectValue,{placeholder:"Status"})]})}),(0,b.jsxs)(u.SelectContent,{children:[(0,b.jsx)(u.SelectItem,{value:"all",children:"All Status"}),(0,b.jsx)(u.SelectItem,{value:"active",children:"Active"}),(0,b.jsx)(u.SelectItem,{value:"blocked",children:"Blocked"})]})]})]})]}),(0,b.jsx)("div",{className:H?"opacity-60 pointer-events-none":"",children:(0,b.jsx)(l.DataTable,{columns:Y,data:Z,currentPage:A,totalPages:w,onPageChange:a=>{S({page:a,search:C,role:D,status:E}),window.scrollTo({top:0,behavior:"smooth"})}})}),(0,b.jsx)(r.Dialog,{open:M.open,onOpenChange:a=>N(b=>({...b,open:a})),children:(0,b.jsxs)(r.DialogContent,{showCloseButton:!1,children:[(0,b.jsxs)(r.DialogHeader,{children:[(0,b.jsx)(r.DialogTitle,{children:"Konfirmasi Perubahan"}),(0,b.jsxs)(r.DialogDescription,{children:["Apakah Anda yakin ingin mengubah"," ","role"===M.type?"role":"status"," ",(0,b.jsx)("strong",{children:M.userName})," dari"," ",(0,b.jsx)("strong",{children:M.currentValue})," menjadi"," ",(0,b.jsx)("strong",{children:M.newValue}),"?"]})]}),(0,b.jsxs)(r.DialogFooter,{children:[(0,b.jsx)(n.Button,{variant:"outline",onClick:()=>N(a=>({...a,open:!1})),children:"Batal"}),(0,b.jsx)(n.Button,{onClick:V,children:"Ya, Ubah"})]})]})}),(0,b.jsx)(r.Dialog,{open:O.open,onOpenChange:a=>P(b=>({...b,open:a,showConfirm:!1})),children:(0,b.jsxs)(r.DialogContent,{children:[(0,b.jsxs)(r.DialogHeader,{children:[(0,b.jsx)(r.DialogTitle,{children:O.showConfirm?"Konfirmasi Perubahan":"Edit Pengguna"}),O.showConfirm&&(0,b.jsx)(r.DialogDescription,{children:"Apakah Anda yakin ingin menyimpan perubahan ini?"})]}),O.showConfirm?null:(0,b.jsxs)("div",{className:"grid gap-4 py-4",children:[(0,b.jsxs)("div",{className:"grid gap-2",children:[(0,b.jsx)(t.Label,{htmlFor:"fullname",children:"Nama Lengkap"}),(0,b.jsx)(s.Input,{id:"fullname",value:O.fullname,onChange:a=>P(b=>({...b,fullname:a.target.value}))})]}),(0,b.jsxs)("div",{className:"grid gap-2",children:[(0,b.jsx)(t.Label,{htmlFor:"username",children:"Username"}),(0,b.jsx)(s.Input,{id:"username",value:O.username,onChange:a=>P(b=>({...b,username:a.target.value}))})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{className:"grid gap-2",children:[(0,b.jsx)(t.Label,{htmlFor:"role",children:"Role"}),(0,b.jsxs)(u.Select,{value:O.role,onValueChange:a=>P(b=>({...b,role:a})),children:[(0,b.jsx)(u.SelectTrigger,{children:(0,b.jsx)(u.SelectValue,{})}),(0,b.jsxs)(u.SelectContent,{children:[(0,b.jsx)(u.SelectItem,{value:"user",children:"User"}),(0,b.jsx)(u.SelectItem,{value:"admin",children:"Admin"})]})]})]}),(0,b.jsxs)("div",{className:"grid gap-2",children:[(0,b.jsx)(t.Label,{htmlFor:"status",children:"Status"}),(0,b.jsxs)(u.Select,{value:O.status,onValueChange:a=>P(b=>({...b,status:a})),children:[(0,b.jsx)(u.SelectTrigger,{children:(0,b.jsx)(u.SelectValue,{})}),(0,b.jsxs)(u.SelectContent,{children:[(0,b.jsx)(u.SelectItem,{value:"active",children:"Active"}),(0,b.jsx)(u.SelectItem,{value:"blocked",children:"Blocked"})]})]})]})]})]}),(0,b.jsxs)(r.DialogFooter,{children:[(0,b.jsx)(n.Button,{variant:"outline",onClick:()=>P(a=>({...a,open:!1,showConfirm:!1})),children:"Batal"}),(0,b.jsx)(n.Button,{onClick:W,children:O.showConfirm?"Ya, Simpan":"Simpan"})]})]})}),(0,b.jsx)(r.Dialog,{open:Q.open,onOpenChange:a=>R(b=>({...b,open:a,confirmText:""})),children:(0,b.jsxs)(r.DialogContent,{showCloseButton:!1,children:[(0,b.jsxs)(r.DialogHeader,{children:[(0,b.jsx)(r.DialogTitle,{className:"text-destructive",children:"Move to Trash"}),(0,b.jsxs)(r.DialogDescription,{children:["Are you sure you want to move"," ",(0,b.jsx)("strong",{children:Q.userName})," to the trash? You can restore it later."]})]}),(0,b.jsxs)("div",{className:"grid gap-2 py-4",children:[(0,b.jsxs)(t.Label,{htmlFor:"confirmDelete",children:["Type ",(0,b.jsx)("strong",{className:"text-destructive",children:"Move to Trash"})," ","to confirm"]}),(0,b.jsx)(s.Input,{id:"confirmDelete",value:Q.confirmText,onChange:a=>R(b=>({...b,confirmText:a.target.value})),placeholder:"Type 'Move to Trash' here"})]}),(0,b.jsxs)(r.DialogFooter,{children:[(0,b.jsx)(n.Button,{variant:"outline",onClick:()=>R(a=>({...a,open:!1,confirmText:""})),children:"Cancel"}),(0,b.jsx)(n.Button,{variant:"destructive",onClick:X,disabled:"Move to Trash"!==Q.confirmText,children:"Move to Trash"})]})]})})]})}function B(a){return a.charAt(0).toUpperCase()+a.slice(1).toLowerCase()}a.s(["UserTable",()=>A],54599)}];

//# sourceMappingURL=app_%28dashboard%29_users_user-table_tsx_62d7d0e1._.js.map