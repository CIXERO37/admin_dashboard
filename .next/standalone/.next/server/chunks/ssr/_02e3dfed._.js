module.exports=[3825,a=>{"use strict";var b=a.i(37936),c=a.i(89227);async function d(a){let b=await (0,c.getSupabaseServerClient)(),{data:d,error:e}=await b.from("profiles").select("*").eq("id",a).single();if(e)return console.error("Error fetching profile:",e),{data:null,error:e.message};let f=d.following_count??d.followings_count??0,g=d.followers_count??d.follower_count??0,h=d.friends_count??d.friend_count??0;if(0===f&&0===g){let{count:c,error:d}=await b.from("follows").select("*",{count:"exact",head:!0}).eq("follower_id",a);d||null===c||(f=c);let{count:e,error:h}=await b.from("follows").select("*",{count:"exact",head:!0}).eq("following_id",a);h||null===e||(g=e)}if(0===h){let{count:c,error:d}=await b.from("friendships").select("*",{count:"exact",head:!0}).or(`user_id.eq.${a},friend_id.eq.${a}`).eq("status","accepted");d||null===c||(h=c)}let i=null,j=null,k=null;if(d.country_id){let{data:a}=await b.from("countries").select("id, name, latitude, longitude").eq("id",d.country_id).single();i=a}if(d.state_id){let{data:a}=await b.from("states").select("id, name, latitude, longitude").eq("id",d.state_id).single();j=a}if(d.city_id){let{data:a}=await b.from("cities").select("id, name, latitude, longitude").eq("id",d.city_id).single();k=a}return{data:{...d,following_count:f,followers_count:g,friends_count:h,country:i,state:j,city:k},error:null}}async function e(a){let b=await (0,c.getSupabaseServerClient)(),{data:d,error:e}=await b.from("game_sessions").select("quiz_id, participants");if(e)return console.error("Error fetching game sessions:",e),{data:[],error:e.message};let f={};for(let b of d??[]){let c=b.participants;if(c&&Array.isArray(c)){let d=c.find(b=>b.user_id===a);d&&(f[b.quiz_id]||(f[b.quiz_id]={count:0,totalScore:0}),f[b.quiz_id].count+=1,f[b.quiz_id].totalScore+=d.score??0)}}let g=Object.entries(f).sort((a,b)=>b[1].count-a[1].count).slice(0,10).map(([a])=>a);if(0===g.length)return{data:[],error:null};let{data:h,error:i}=await b.from("quizzes").select("id, title").in("id",g);return i?(console.error("Error fetching quizzes:",i),{data:[],error:i.message}):{data:(h??[]).map(a=>{let b=f[a.id]||{count:0,totalScore:0};return{id:a.id,title:a.title,play_count:b.count,avg_score:b.count>0?Math.round(b.totalScore/b.count):0}}).sort((a,b)=>b.play_count-a.play_count),error:null}}async function f(a){let b=await (0,c.getSupabaseServerClient)(),{data:d,error:e}=await b.from("quizzes").select("id, title, category, questions, created_at").eq("creator_id",a).is("deleted_at",null).order("created_at",{ascending:!1}).limit(10);return e?(console.error("Error fetching created quizzes:",e),{data:[],error:e.message}):{data:(d??[]).map(a=>({id:a.id,title:a.title,category:a.category,question_count:Array.isArray(a.questions)?a.questions.length:0,created_at:a.created_at})),error:null}}(0,a.i(13095).ensureServerEntryExports)([d,e,f]),(0,b.registerServerReference)(d,"4014a9e9d9809d90772414f31ae207ca1d2fd6dcad",null),(0,b.registerServerReference)(e,"40a8dbf7b59f5859d63a542ccf3de4c843b81cac74",null),(0,b.registerServerReference)(f,"405298d407b02c4c08bb21300ac8af71ff5c557013",null),a.s(["fetchCreatedQuizzes",()=>f,"fetchProfileById",()=>d,"fetchUserQuizzes",()=>e])},66614,a=>{"use strict";var b=a.i(51203),c=a.i(3825);a.s([],56008),a.i(56008),a.s(["0036e64456fb2be9f284aa63a8876a0297f090e2e1",()=>b.logout,"4014a9e9d9809d90772414f31ae207ca1d2fd6dcad",()=>c.fetchProfileById,"405298d407b02c4c08bb21300ac8af71ff5c557013",()=>c.fetchCreatedQuizzes,"40a8dbf7b59f5859d63a542ccf3de4c843b81cac74",()=>c.fetchUserQuizzes],66614)}];

//# sourceMappingURL=_02e3dfed._.js.map